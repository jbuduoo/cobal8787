<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首頁 - 登錄驗證</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        .hidden {
            display: none;
        }
        .visible {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Google 登錄按鈕 -->
    <div id="login-container" class="visible">
        <h1>請先登錄</h1>
        <div id="g_id_onload"
          data-client_id="520298354348-dcib1u7qp2bmhkvbi3vmnijdf5eusakv.apps.googleusercontent.com"
          data-login_uri="https://jbuduoo.github.io/cobal8787"
          data-ux_mode="popup"
          data-auto_prompt="false">
        </div>
        <div class="g_id_signin"
            data-type="standard"
            data-shape="rectangular"
            data-theme="outline"
            data-text="signin_with"
            data-size="large">
        </div>        
    </div>

    <!-- 首頁內容 -->
    <div id="homepage-container" class="hidden">
        <h1>歡迎來到首頁</h1>
        <p>這是您的私人首頁，只有登錄後才能查看。</p>
        <button onclick="logout()">登出</button>
    </div>

    <script>

        function handleCredentialResponse(response) {
            const payload = JSON.parse(atob(response.credential.split('.')[1])); // 解碼 ID Token
            console.log('User Info:', payload);

            // 驗證成功後顯示首頁內容
            document.getElementById("login-container").classList.add("hidden");
            document.getElementById("homepage-container").classList.remove("hidden");

            // 渲染用戶信息
            document.getElementById("user-name").textContent = payload.name;
            document.getElementById("user-email").textContent = payload.email;
        }


        function logout() {
            // 登出時隱藏首頁內容，顯示登錄按鈕
            document.getElementById("login-container").classList.remove("hidden");
            document.getElementById("homepage-container").classList.add("hidden");
        }

        // 初始化 Google 登錄
        window.onload = () => {
            google.accounts.id.initialize({
                client_id: "520298354348-dcib1u7qp2bmhkvbi3vmnijdf5eusakv.apps.googleusercontent.com", // 替換為您的 Google 客戶端 ID
                callback: handleCredentialResponse
            });
            google.accounts.id.prompt(); // 可選，彈出自動登錄提示
        };
    </script>
</body>
</html>
